---
ID: 10041
post_title: >
  Upgrading from the TFS 2013 Preview to
  TFS 2013 RC
post_name: >
  upgrading-from-the-tfs-2013-preview-to-tfs-2013-rc
author: >
  Martin Hinshelwood (He/Him)
  nkdAgility.com
post_date: 2013-09-09 10:30:38
post_excerpt: '<p class="lead">With the TFS 2013 RC being made available I need to upgrade one of my main customers from the TFS 2013 Preview.</p>'
layout: post
link: >
  https://nkdagility.com/blog/upgrading-from-the-tfs-2013-preview-to-tfs-2013-rc/
published: true
tags:
  - TFS
  - TFS 2013
  - upgrade
categories:
  - 'Install &amp; Configure'
  - 'Upgrade &amp; Maintenance'
---
<p class="lead">With the <a href="http://nakedalmweb.wpengine.com/whats-new-in-visual-studio-2013-rc-with-team-foundation-server/" target="_blank">TFS 2013 RC</a> being made available I need to upgrade one of my main customers from the TFS 2013 Preview.</p>
<p>I have been working with a fairly progressive customer that has no qualms to using the latest version of any software as long as it is supported. They have around 500 developers in Team Foundation Server and 2-3TB of data. No that was not a typo. Although they have 500 active engineers there are around 9000 user accounts that have permission to TFS. This is the <a href="http://nakedalmweb.wpengine.com/engaging-with-complexity-team-foundation-server-edition/" target="_blank">Engaging with complexity – TFS Edition</a> customer that was moving through many environments. They since managed to streamline their processes and I have been working with them for a while. We have done maybe 10 to 15 upgrades of the 2TB collection across five separate environments over the last few months practicing for the production move. All with Team Foundation Server 2013 Preview. And we have had no problems at all. Indeed when we moved to 2013 many of the issues that we had disappeared.</p>
<p>Now that the RC is available and with production only a week away I needed to do a trial upgrade of their Sandbox environment to make sure that everything will work for Production. In fact it went so well (took around an hour) that we went ahead and upgraded the soon to be production server that very day. I can also confirm that the move to production of the data and users has been completed successfully…</p>
<h2>Upgrading Sandbox 2TB data to Team Foundation Server 2013 RC</h2>
<p>Some thing that I can’t stress more is to always do a trial upgrade. If, unlike this customer, you have limited hardware then I would recommend that you create a new virtual environment to replace your current TFS virtual servers. This will allow you to run a trial upgrade without impacting production and your infrastructure teams can reclaim the old VM’s once you are done.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image28.png" width="800" height="450"><br><small>Figure: Current TFS Environment is Server 2008 R2 with TFS 2013 Preview</small></p>
<p>I really have no expectation of a long or complicated upgrade form the Preview to the RC however you do want to check that the OS is supported as Windows Server 2012 R2 Preview and Windows 8.1 Preview is not supported by the RC.</p>
<h2>Prerequisites – make sure that you have…</h2>
<ul>
<li>Passwords for your TF Service &amp; TF Reports accounts
<li>Windows Server 2008 R2 or Windows Server 2012 (NOT 2012 R2 or 8.1 Preview)
<li>SQL Server 2012 Service Pack 1</li>
</ul>
<h2>Installing TFS 2013 RC when you have TFS 2013 Preview (30 minutes)</h2>
<p>It has been a long time since you had to manually uninstall the old version of TFS to install the new. The installer will take care of all that clean up for you.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image29.png" width="800" height="450"><br><small>Figure: Installing Team Foundation Server 2013 RC</small></p>
<p>The only reason that the install of the new version takes so long is that it requires two reboots and asks you to do so.</p>
<blockquote><p>It would make sense to ask if reboots are ok at the start of the install and just go for it. Suggestion for Installer Team</p>
</blockquote>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image30.png" width="800" height="450"><br><small>Figure: Reboot to install the C++ 2013 Runtime</small></p>
<p>The first forced reboot is the Microsoft Visual C++ 2013 Runtime. Because we are updating from a preview we will have more reboots than a clean install.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image31.png" width="800" height="450"><br><small>Figure: Reboot to install .NET 4.5.1 RC</small></p>
<p>The second forced reboot is to get the Microsoft .NET Framework 4.5.1 updated to the RC from the Preview version that you had installed. If you are doing a clean install you will not have to do this one at all..</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image32.png" width="800" height="450"><br><small>Figure: The Upgrade Wizard will launch automatically</small></p>
<p>To be honest this would have taken less time if I was sitting watching the screen, and pinging the server between boots to see when it was back up. As it was I took a leisurely 30 minutes to install Team Foundation Server 2013 RC over the top of the Preview. But that is not us done, this is just the files on disk and dependencies that have been updated. Now comes the real work of upgrading the instance of TFS 2013 Preview to TFS 2013 RC.</p>
<h2>Upgrading from the TFS 2013 Preview to TFS 2013 RC (16 Minutes)</h2>
<p>As with the TFS 2013 preview there is really not anything that new in the installer. Things are a little bit slicker and I have noticed a significant drop in failed upgrades, from a few to none. The experience of the team in delivering working software every 3 weeks in 2012 has set the Product Team in good stead to minimise any issues here. I also expect that the shame of TFS 2012 Update 1 and 2 has resulted in a significantly higher quality bar for Done. Suck are the trials of moving a large product group to agility.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image33.png" width="800" height="450"><br><small>Figure: make sure that you have a Backup</small></p>
<p>Its so important there is a yellow triangle and a checkbox! Make sure, and I mean really sure, that you have a backup of your data. One of the reasons that I always recommend moving to new hardware on an upgrade is that you can always roll back to the old hardware. Makes your back-out plan real simple…</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image34.png" width="800" height="450"><br><small>Figure: Renter your credentials</small></p>
<p>No, the product team don’t store your credentials in reversible encryption. Yes, you will have to enter the passwords again so make sure that you have them, but the username that you used last time will be pre-populated. I tend to try and use the system accounts to negate these issues, but some domain configurations don’t work well with them. Unless you are insane you are likely to be using NTLM. I have no issues with configuring Kerberos but you will need more time and some seriously good AD administrators to get it going.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image35.png" width="800" height="450"><br><small>Figure: Do you configure reporting?</small></p>
<p>In this environment we do have reporting as it mirrors production. If you don’t configure it now you will have to manfully integrate it later and upgrade the reports yourself. This way the TFS team take the brunt of the configuration.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image36.png" width="800" height="450"><br><small>Figure: Select the Reports Server and URL</small></p>
<p>Here you can select your Reporting Services Server. This is a multi server (dual tier) environment so our Reporting Services runs on the Application Tier and the SQL Server and Analysis Services run on the Data Tier. If you want to have a friendly URL for Reporting Services then you should add it as a host header to the Reporting Services Configuration tool first for both the Web Services and the Web Site nodes. This will allow the URL’s you specify to appear on the pick lists above. </p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image37.png" width="800" height="450"><br><small>Figure: Select Warehouse to upgrade</small></p>
<p>As it takes more than a few hours to create a new warehouse from scratch you can upgrade it. From TFS 2012 onward you should restore the Tfs_Warehouse database as well and the upgrade process will also upgrade the warehouse.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image38.png" width="800" height="450"><br><small>Figure: Select the Analysis Services instance</small></p>
<p>You can have Analysis Services on it own server but most people go with the standard and documented Dual-Tier architecture. If you are hitting massive performance problems and it looks like Analysis Services is the cause you can break it off to another server later.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image39.png" width="800" height="450"><br><small>Figure: The Report Reader Account</small></p>
<p>Although you can use the same account as the TFS service account this account really only needs reader access to things. It is best to use an Active Directory account that has no other permissions. </p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image40.png" width="800" height="450"><br><small>Figure: Readiness Checks to validate your configuration</small></p>
<p>Gone are the days of TFS 2005 and 2008 where the slightest hiccup would result in a failed and irrecoverable installation. Now the wizard will check everything and anything that it can before giving you the green light to move forward. Maybe it is RAM or maybe it is a reboot required… or maybe…</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image41.png" width="800" height="450"><br><small>Figure: The installer needs SysAdmin</small></p>
<p>Um… can someone make me a SysAdmin?</p>
<p>Not only does the TFS service account require SysAdmin but all of those people that are registered Team Foundation Console users also require to be SysAdmin. Think of the SQL Server that TFS uses as wholly owned by TFS and it will handle backups and permissions from here on out. </p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image42.png" width="800" height="450"><br><small>Figure: Green light… go … go… go…</small></p>
<p>Now that we have all of the readiness checks passed we can really upgrade…</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image43.png" width="800" height="450"><br><small>Figure: Upgrading the Configuration Database</small></p>
<p>The wizard will first upgrade the configuration database and satlight data sets and then tackle the collections asynchronously.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image44.png" width="800" height="450"><br><small>Figure: Upgrading the collections</small></p>
<p>You may have a number of collections then they will be upgraded asynchronously and there are 92 steps for the Preview to RC. If it gets to 87 and sits there for a while there is nothing to worry about</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image45.png" width="800" height="450"><br><small>Figure: Green tick… i am happy</small></p>
<p>Although the total time end to end was 45 minutes at least some of that time was taken up with looking for passwords and taking screenshots. I would think that if I really tried I could cut 15 minutes of that time, but hey… its done now.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image46.png" width="800" height="450"><br><small>Figure: All upgraded to Visual Studio 2013 Team Foundation Server RC</small></p>
<p>Second last thing to check is that the admin console shows the correct version. I have of course never seen it not <img class="wlEmoticon wlEmoticon-smile" style="border-top-style: none; border-bottom-style: none; border-right-style: none; border-left-style: none" alt="Smile" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/wlEmoticon-smile.png"></p>
<h2>Conclusion</h2>
<p>If you are on the Preview then it is a no brainer and simple task to go to the RC and if you are on 2010 or 2012 I would recommend that you take a look at [What's new in Team Foundation Server 2013] and see what's in there for you.</p>
<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://nakedalmweb.wpengine.com/wp-content/uploads/2013/08/image47.png" width="800" height="450"><br><small>Figure: Primary Team Dashboard in action</small></p>
<p>I recommend that you check out this <a href="http://nakedalmweb.wpengine.com/video-new-with-visual-studio-2013-manage-portfolio-backlogs-to-understand-the-scope-of-work/" target="_blank">walkthrough of the ALM features in Team Foundation Server 2013</a>. I have never shown users the features of 2013 and not had them immediately upgrade to the Preview. Lets see if I can keep that up with the RC.</p>
